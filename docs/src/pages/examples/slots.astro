---
import ExampleLayout from '../../layouts/ExampleLayout.astro';
import { getSpecUrl } from '../../utils/getSpecUrl';

const specUrl = getSpecUrl(Astro.url);
---

<ExampleLayout>
  <rapi-doc 
    id = "thedoc"
    spec-url = {specUrl}
    show-header = "true"
    render-style = "read"
    show-info = "true"
  > 

    <p style="margin:0; padding:16px 36px; background-color:tomato; color:#fff; text-align:center;" > 
      <b> default</b> slot | <span style="font-size:12px"> A good place to provide internal and external links, Sign In buttons etc</span>
    </p>

    <span slot="overview" >
      <p style="margin-top:10px; padding:16px 36px; background-color:MediumSeaGreen; color:#fff; text-align:center;" > 
        <b> overview</b> slot | <span style="font-size:12px"> good for business flow explenation</span>
      </p>
      <div style="display:flex; flex-direction:column; align-items: center; font-size:13px; color: #777;">
        <div> Provide explenations, diagrams and other HTML controls. You may also style them to your needs</div>
        <img src = "/assets/images/arch.png" style="width:350px;">
      </div>
    </span>

    <p slot="servers" style="margin-top:10px; padding:16px 36px; background-color:SlateBlue; color:#fff; text-align:center;" > 
      <b> servers</b> slot| <span style="font-size:12px"> good for describing about the API gateways, load balancers application servers etc</span>
    </p>

    <span slot="auth" >
      <p style="margin-top:10px; padding:16px 36px; background-color:DodgerBlue; color:#fff; text-align:center;" >
        <b> auth</b> slot | <span style="font-size:12px"> good for describing authentication system</span>
      </p>  
      <div style="display:flex; align-items:center; font-size:13px; color: #777;">
        <div class="mermaid" style="width:400px; background: #999; padding:16px; border-radius: 8px;">
          {`
          graph TB
            API-Gateway --> Authentication-Server
            Authentication-Server-->A[fa:fa-ban Invalid Token]
            Authentication-Server-->B[fa:fa-ban Valid Token]
            A --> 401[401 Response Status]
            B --> 200[200 response Status<br/> with JSON payload]
          `}  
        </div>
        <div style="margin-left:16px; "> 
          You may even introduce some JS based functionality 
          For instance, the digram on the left is generated by a flowchart markup rederer <a target="_blank" href= "https://mermaid-js.github.io/mermaid/#/"> mermaid </a>
          You can change them dynamically using scrpts
          <br/><br/>
          You may also provide HTML buttons and attach scripts to them to perform automatic authentication for your visitors. 
        </div>
      </div>
    </span>

    <span slot="operations-top" >
      <p style="margin-top:10px; padding:16px 36px; background-color:#a5522e; color:#fff; text-align:center;" > 
        <b> overview</b> slot | <span style="font-size:12px"> Good for contents that applies to all operations/api</span>
      </p>
    </span>


    <p slot="tag--user" style="margin-top:10px; padding:16px 36px; background-color:#ac7339; color:#fff; text-align:center;" > 
      <b> tag--user</b> slot
    </p>

    <p slot="tag--Create-User" style="margin-top:10px; padding:16px 36px; background-color:#ac7339; color:#fff; text-align:center;" > 
      <b> tag--Create-User</b> slot
    </p>

    <p slot="post-/users" style="margin-top:10px; padding:16px 36px; background-color:orangered; color:#fff; text-align:center;" > 
      <b> post-/users</b> slot | <span style="font-size:12px"> Inject HTML content specific to a path if needed</span>
    </p>

    <p slot="footer" style="margin:0; padding:16px 36px; background-color:orange; color:#fff; text-align:center;" > 
      <b> footer</b> slot | <span style="font-size:12px"> may provide copyright info and other links</span>
    </p>

    <div slot="nav-logo" style="display: flex; align-items: center; justify-content: center;"> 
      <img src = "/assets/images/dog.png" style="width:40px; margin-right: 20px"> <span style="color:#fff"> <b>nav-logo</b> slot </span>
    </div>


  </rapi-doc>
</ExampleLayout>

<script is:inline src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script is:inline> mermaid.initialize({startOnLoad:true});</script>

<script is:inline>
  document.addEventListener('DOMContentLoaded', (event) => {
    let docEl = document.getElementById("thedoc");
    docEl.addEventListener('after-try', (e) => {
      console.log(e.detail);
    });
  })
</script>
